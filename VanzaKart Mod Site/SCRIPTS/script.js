const translations = {
    it: {
        "meta.title": "VanzaKart Modpack - The Ultimate Mario Kart Wii Experience",
        "meta.desc": "Scarica VanzaKart, il nuovo modpack per Mario Kart Wii su Dolphin. Unisciti alla gara con il nostro launcher esclusivo!",
        "meta.desc": "Scarica VanzaKart, il nuovo modpack per Mario Kart Wii su Dolphin. Unisciti alla gara con il nostro launcher esclusivo!",
        "nav.home": "Home",
        "hero.title": "Rivoluziona il tuo <br><span class=\"gradient-text\">Mario Kart Wii</span>",
        "hero.subtitle": "VanzaKart è il modpack definitivo da giocare su Dolphin. Nuove piste, nuovi personaggi, e un launcher sviluppato appositamente per un'esperienza fluida e immediata.",
        "hero.cta.download": "Scarica il Launcher",
        "hero.cta.discord": "Unisciti alla Community",
        "features.title": "Perché scegliere <span class=\"gradient-text\">VanzaKart</span>?",
        "features.tracks.title": "Piste Inedite",
        "features.tracks.desc": "Corri su centinaia di tracciati custom creati dalla community e ottimizzati al massimo per un'esperienza di gioco spettacolare.",
        "features.launcher.title": "Launcher Custom",
        "features.launcher.desc": "Dimentica le configurazioni complesse. Il nostro launcher proprietario gestisce tutto automaticamente con un solo click.",
        "features.dolphin.title": "Dolphin-Ready",
        "features.dolphin.desc": "Integrazione perfetta e nativa con l'emulatore Dolphin per garantire prestazioni e stabilità sui PC moderni.",
        "cta.title": "Pronto per accendere i motori?",
        "cta.desc": "Scarica subito il nostro Launcher per PC. Include tutte le patch e gli strumenti per installare VanzaKart in modo automatico.",
        "cta.btn": "Scarica VanzaKart Launcher",
        "cta.note": "Richiede Windows 10/11 - ~3GB (Download Iniziale)",
        "footer.copy": "&copy; 2026 Lacly's Paradise. Tutti i diritti riservati.",
        "footer.discord": "Entra nel server Discord",
        "js.btn.prep": "Preparazione...",
        "js.btn.done": "Download Iniziato!",
        "nav.team": "Il nostro Team",
        "team.meta.title": "VanzaKart Modpack - Il nostro Team",
        "team.hero.title": "Il <span class=\"gradient-text\">Nostro Team</span>",
        "team.hero.subtitle": "I creatori, sviluppatori e collaboratori che hanno reso possibile il progetto VanzaKart.",
        "team.role.devs": "Sviluppatori",
        "team.role.lead": "Lead Developer",
        "team.role.launcher": "Launcher Developer",
        "team.role.web": "Web Developer",
        "team.role.graphics": "Grafica e Audio",
        "team.role.art": "Art & Sound Director",
        "team.role.tester": "Beta Tester",
        "team.role.qa": "QA Tester",
        "team.desc.dev1": "Il creatore del modpack, con un'aggiunta di 152 mappe custom, le migliori custom map.",
        "team.desc.dev2": "Il creatore del launcher.",
        "team.desc.dev3": "Il creatore del sito web, con tutta la sua estetica e informazioni accurate.",
        "team.desc.graphics": "Artista di effetti grafici e di sound design.",
        "team.desc.tester": "Il tester del launcher, ha controllato che non ci fossero bug e che il download fosse ottimale.",
        "team.btn.support": "Supporta",
        "nav.guide": "Guida",
        "guide.meta.title": "VanzaKart Modpack - Guida di Installazione",
        "guide.hero.title": "Guida all'<span class=\"gradient-text\">Installazione</span>",
        "guide.hero.subtitle": "Scopri come installare VanzaKart e configurare Dolphin per iniziare a giocare in pochi minuti.",
        "guide.video.title": "Video Tutorial in Arrivo",
        "guide.video.desc": "Stiamo preparando un video dettagliato per mostrarti tutti i passaggi.",
        "guide.steps.title": "Istruzioni Passo-Passo",
        "guide.step1.title": "Scarica il Launcher",
        "guide.step1.desc": "Visita la pagina principale e clicca sul pulsante di download per ottenere l'eseguibile del nostro Launcher Ufficiale (~3GB).",
        "guide.step2.title": "Avvia l'Installazione",
        "guide.step2.desc": "Esegui il file scaricato. Il launcher si occuperà automaticamente di scaricare le mod aggiornate e configurare l'ambiente di gioco.",
        "guide.step3.title": "Configura Dolphin",
        "guide.step3.desc": "Il launcher integra Dolphin. Al primo avvio, assicurati di configurare il tuo controller (tastiera o joystick) nelle impostazioni dell'emulatore.",
        "guide.step4.title": "Gioca!",
        "guide.step4.desc": "Seleziona \"Avvia VanzaKart\" dal menu del launcher e preparati a sfrecciare sulle nuove piste!"
    },
    en: {
        "meta.title": "VanzaKart Modpack - The Ultimate Mario Kart Wii Experience",
        "meta.desc": "Download VanzaKart, the new Mario Kart Wii modpack for Dolphin. Join the race with our exclusive launcher!",
        "meta.desc": "Download VanzaKart, the new Mario Kart Wii modpack for Dolphin. Join the race with our exclusive launcher!",
        "nav.home": "Home",
        "hero.title": "Revolutionize your <br><span class=\"gradient-text\">Mario Kart Wii</span>",
        "hero.subtitle": "VanzaKart is the ultimate modpack to play on Dolphin. New tracks, new characters, and a launcher specifically developed for a seamless experience.",
        "hero.cta.download": "Download Launcher",
        "hero.cta.discord": "Join the Community",
        "features.title": "Why choose <span class=\"gradient-text\">VanzaKart</span>?",
        "features.tracks.title": "Brand New Tracks",
        "features.tracks.desc": "Race on hundreds of custom tracks created by the community and highly optimized for spectacular gameplay.",
        "features.launcher.title": "Custom Launcher",
        "features.launcher.desc": "Forget complex configurations. Our proprietary launcher handles everything automatically with a single click.",
        "features.dolphin.title": "Dolphin-Ready",
        "features.dolphin.desc": "Perfect native integration with the Dolphin emulator to ensure performance and stability on modern PCs.",
        "cta.title": "Ready to start your engines?",
        "cta.desc": "Download our PC Launcher now. It includes all patches and tools to automatically install VanzaKart.",
        "cta.btn": "Download VanzaKart Launcher",
        "cta.note": "Requires Windows 10/11 - ~3GB (Initial Download)",
        "footer.copy": "&copy; 2026 Lacly's Paradise. All rights reserved.",
        "footer.discord": "Join the Discord server",
        "js.btn.prep": "Preparing...",
        "js.btn.done": "Download Started!",
        "nav.team": "Our Team",
        "team.meta.title": "VanzaKart Modpack - Our Team",
        "team.hero.title": "Our <span class=\"gradient-text\">Team</span>",
        "team.hero.subtitle": "The creators, developers, and collaborators who made the VanzaKart project possible.",
        "team.role.devs": "Developers",
        "team.role.lead": "Lead Developer",
        "team.role.launcher": "Launcher Developer",
        "team.role.web": "Web Developer",
        "team.role.graphics": "Graphics & Audio",
        "team.role.art": "Art & Sound Director",
        "team.role.tester": "Beta Tester",
        "team.role.qa": "QA Tester",
        "team.desc.dev1": "The creator of the modpack, featuring an addition of 152 custom maps, the best custom maps.",
        "team.desc.dev2": "The creator of the launcher.",
        "team.desc.dev3": "The creator of the website, with all its aesthetics and accurate information.",
        "team.desc.graphics": "Visual effects and sound design artist.",
        "team.desc.tester": "The launcher tester, checked that there were no bugs and that the download was optimal.",
        "team.btn.support": "Support",
        "nav.guide": "Guide",
        "guide.meta.title": "VanzaKart Modpack - Installation Guide",
        "guide.hero.title": "Installation <span class=\"gradient-text\">Guide</span>",
        "guide.hero.subtitle": "Learn how to install VanzaKart and configure Dolphin to start playing in minutes.",
        "guide.video.title": "Video Tutorial Coming Soon",
        "guide.video.desc": "We are preparing a detailed video to show you all the steps.",
        "guide.steps.title": "Step-by-Step Instructions",
        "guide.step1.title": "Download the Launcher",
        "guide.step1.desc": "Visit the main page and click the download button to get our Official Launcher executable (~3GB).",
        "guide.step2.title": "Start Installation",
        "guide.step2.desc": "Run the downloaded file. The launcher will automatically handle downloading updated mods and configuring the game environment.",
        "guide.step3.title": "Configure Dolphin",
        "guide.step3.desc": "The launcher embeds Dolphin. On the first launch, make sure to configure your controller (keyboard or gamepad) in the emulator settings.",
        "guide.step4.title": "Play!",
        "guide.step4.desc": "Select \"Launch VanzaKart\" from the launcher menu and get ready to race on new tracks!"
    },
    de: {
        "meta.title": "VanzaKart Modpack - Das ultimative Mario Kart Wii Erlebnis",
        "meta.desc": "Lade VanzaKart herunter, das neue Mario Kart Wii Modpack für Dolphin. Tritt dem Rennen mit unserem exklusiven Launcher bei!",
        "meta.desc": "Lade VanzaKart herunter, das neue Mario Kart Wii Modpack für Dolphin. Tritt dem Rennen mit unserem exklusiven Launcher bei!",
        "nav.home": "Startseite",
        "hero.title": "Revolutioniere dein <br><span class=\"gradient-text\">Mario Kart Wii</span>",
        "hero.subtitle": "VanzaKart ist das ultimative Modpack für Dolphin. Neue Strecken, neue Charaktere und ein eigens entwickelter Launcher für ein reibungsloses Erlebnis.",
        "hero.cta.download": "Launcher Herunterladen",
        "hero.cta.discord": "Der Community Beitreten",
        "features.title": "Warum <span class=\"gradient-text\">VanzaKart</span> wählen?",
        "features.tracks.title": "Brandneue Strecken",
        "features.tracks.desc": "Fahre auf Hunderten von fantastischen benutzerdefinierten Strecken, die von der Community erstellt wurden.",
        "features.launcher.title": "Eigener Launcher",
        "features.launcher.desc": "Vergiss komplexe Konfigurationen. Unser proprietärer Launcher erledigt alles automatisch.",
        "features.dolphin.title": "Dolphin-Ready",
        "features.dolphin.desc": "Perfekte native Integration mit dem Dolphin-Emulator, um Leistung und Stabilität zu gewährleisten.",
        "cta.title": "Bereit, die Motoren zu starten?",
        "cta.desc": "Lade jetzt unseren PC-Launcher herunter. Er enthält alle Tools zur automatischen Installation.",
        "cta.btn": "VanzaKart Launcher Herunterladen",
        "cta.note": "Erfordert Windows 10/11 - ~3GB (Initialer Download)",
        "footer.copy": "&copy; 2026 Lacly's Paradise. Alle Rechte vorbehalten.",
        "footer.discord": "Tritt dem Discord-Server bei",
        "js.btn.prep": "Vorbereitung...",
        "js.btn.done": "Download gestartet!",
        "nav.team": "Unser Team",
        "team.meta.title": "VanzaKart Modpack - Unser Team",
        "team.hero.title": "Unser <span class=\"gradient-text\">Team</span>",
        "team.hero.subtitle": "Die Macher und Entwickler, die das VanzaKart-Projekt möglich gemacht haben.",
        "team.role.devs": "Entwickler",
        "team.role.lead": "Hauptentwickler",
        "team.role.launcher": "Launcher-Entwickler",
        "team.role.web": "Webentwickler",
        "team.role.graphics": "Grafik & Audio",
        "team.role.art": "Art & Sound Director",
        "team.role.tester": "Beta-Tester",
        "team.role.qa": "QA-Tester",
        "team.desc.dev1": "Der Schöpfer des Modpacks, mit einer Erweiterung von 152 benutzerdefinierten Karten, den besten Custom Maps.",
        "team.desc.dev2": "Der Schöpfer des Launchers.",
        "team.desc.dev3": "Der Ersteller der Website, mit ihrer gesamten Ästhetik und genauen Informationen.",
        "team.desc.graphics": "Künstler für visuelle Effekte und Sounddesign.",
        "team.desc.tester": "Der Launcher-Tester, hat überprüft, dass es keine Fehler gab und dass der Download optimal war.",
        "team.btn.support": "Unterstützen",
        "nav.guide": "Anleitung",
        "guide.meta.title": "VanzaKart Modpack - Installationsanleitung",
        "guide.hero.title": "Installations-<span class=\"gradient-text\">Anleitung</span>",
        "guide.hero.subtitle": "Erfahre, wie du VanzaKart installierst und Dolphin für das Spielen konfigurierst.",
        "guide.video.title": "Video-Tutorial kommt bald",
        "guide.video.desc": "Wir bereiten ein detailliertes Video vor, um dir alle Schritte zu zeigen.",
        "guide.steps.title": "Schritt-für-Schritt-Anleitung",
        "guide.step1.title": "Lade den Launcher herunter",
        "guide.step1.desc": "Besuche die Hauptseite und lade die ausführbare Datei unseres Launchers herunter.",
        "guide.step2.title": "Starte die Installation",
        "guide.step2.desc": "Führe die heruntergeladene Datei aus. Der Launcher lädt automatisch Mods herunter.",
        "guide.step3.title": "Konfiguriere Dolphin",
        "guide.step3.desc": "Stelle beim ersten Start sicher, dass du deinen Controller in Dolphin konfigurierst.",
        "guide.step4.title": "Spielen!",
        "guide.step4.desc": "Wähle \"Launch VanzaKart\" und mach dich bereit!"
    },
    fr: {
        "meta.title": "VanzaKart Modpack - L'expérience Ultime Mario Kart Wii",
        "meta.desc": "Téléchargez VanzaKart, le nouveau modpack Mario Kart Wii pour Dolphin. Lancez-vous avec notre launcher exclusif !",
        "meta.desc": "Téléchargez VanzaKart, le nouveau modpack Mario Kart Wii pour Dolphin. Lancez-vous avec notre launcher exclusif !",
        "nav.home": "Accueil",
        "hero.title": "Révolutionnez votre <br><span class=\"gradient-text\">Mario Kart Wii</span>",
        "hero.subtitle": "VanzaKart est le modpack ultime pour jouer sur Dolphin. Nouveaux circuits, personnages et un launcher développé pour une expérience fluide.",
        "hero.cta.download": "Télécharger le Launcher",
        "hero.cta.discord": "Rejoindre la Communauté",
        "features.title": "Pourquoi choisir <span class=\"gradient-text\">VanzaKart</span> ?",
        "features.tracks.title": "Nouveaux Circuits",
        "features.tracks.desc": "Courez sur des centaines de circuits personnalisés créés par la communauté.",
        "features.launcher.title": "Launcher Custom",
        "features.launcher.desc": "Oubliez les configurations. Notre launcher gère tout automatiquement.",
        "features.dolphin.title": "Prêt pour Dolphin",
        "features.dolphin.desc": "Intégration native avec l'émulateur Dolphin pour garantir performances et stabilité.",
        "cta.title": "Prêt à faire chauffer les moteurs ?",
        "cta.desc": "Téléchargez notre Lanceur dès maintenant. Il inclut tout pour installer VanzaKart automatiquement.",
        "cta.btn": "Télécharger VanzaKart Launcher",
        "cta.note": "Nécessite Windows 10/11 - ~3GB (Téléchargement Initial)",
        "footer.copy": "&copy; 2026 Lacly's Paradise. Tous droits réservés.",
        "footer.discord": "Rejoindre le serveur Discord",
        "js.btn.prep": "Préparation...",
        "js.btn.done": "Téléchargement Commencé !",
        "nav.team": "Notre Équipe",
        "team.meta.title": "VanzaKart Modpack - Notre Équipe",
        "team.hero.title": "Notre <span class=\"gradient-text\">Équipe</span>",
        "team.hero.subtitle": "Les créateurs et collaborateurs qui ont rendu le projet possible.",
        "team.role.devs": "Développeurs",
        "team.role.lead": "Développeur Principal",
        "team.role.launcher": "Développeur du Launcher",
        "team.role.web": "Développeur Web",
        "team.role.graphics": "Graphismes & Audio",
        "team.role.art": "Art & Sound Director",
        "team.role.tester": "Beta Testeur",
        "team.role.qa": "QA Testeur",
        "team.desc.dev1": "Le créateur du modpack, avec un ajout de 152 cartes personnalisées, les meilleures cartes personnalisées.",
        "team.desc.dev2": "Le créateur du launcher.",
        "team.desc.dev3": "Le créateur du site web, avec toute son esthétique et ses informations précises.",
        "team.desc.graphics": "Artiste des effets visuels et du design sonore.",
        "team.desc.tester": "Le testeur du launcher, a vérifié qu'il n'y avait aucun bug et que le téléchargement était optimal.",
        "team.btn.support": "Soutenir",
        "nav.guide": "Guide",
        "guide.meta.title": "VanzaKart Modpack - Guide d'Installation",
        "guide.hero.title": "Guide <span class=\"gradient-text\">d'Installation</span>",
        "guide.hero.subtitle": "Apprenez à installer VanzaKart et configurer Dolphin.",
        "guide.video.title": "Tutoriel Vidéo Bientôt",
        "guide.video.desc": "Nous préparons une vidéo pour vous montrer les étapes.",
        "guide.steps.title": "Instructions Étape par Étape",
        "guide.step1.title": "Télécharger le Launcher",
        "guide.step1.desc": "Visitez la page principale et téléchargez notre Launcher Officiel.",
        "guide.step2.title": "Démarrer l'Installation",
        "guide.step2.desc": "Exécutez le fichier. Le launcher se chargera de tout télécharger.",
        "guide.step3.title": "Configurer Dolphin",
        "guide.step3.desc": "Assurez-vous de configurer votre manette dans l'émulateur.",
        "guide.step4.title": "Jouez !",
        "guide.step4.desc": "Sélectionnez \"Launch VanzaKart\" et préparez-vous à courir !"
    },
    es: {
        "meta.title": "VanzaKart Modpack - La experiencia definitiva de Mario Kart Wii",
        "meta.desc": "Descarga VanzaKart, el nuevo modpack de Mario Kart Wii para Dolphin. ¡Únete a la carrera con nuestro launcher exclusivo!",
        "meta.desc": "Descarga VanzaKart, el nuevo modpack de Mario Kart Wii para Dolphin. ¡Únete a la carrera con nuestro launcher exclusivo!",
        "nav.home": "Inicio",
        "hero.title": "Revoluciona tu <br><span class=\"gradient-text\">Mario Kart Wii</span>",
        "hero.subtitle": "VanzaKart es el modpack definitivo para jugar en Dolphin. Nuevas pistas, personajes y un launcher desarrollado para una experiencia fluida.",
        "hero.cta.download": "Descargar el Launcher",
        "hero.cta.discord": "Únete a la Comunidad",
        "features.title": "¿Por qué elegir <span class=\"gradient-text\">VanzaKart</span>?",
        "features.tracks.title": "Pistas Nuevas",
        "features.tracks.desc": "Corre en cientos de pistas personalizadas creadas por la comunidad y altamente optimizadas.",
        "features.launcher.title": "Launcher Custom",
        "features.launcher.desc": "Olvida las configuraciones complejas. Nuestro launcher maneja todo automáticamente con un solo clic.",
        "features.dolphin.title": "Listo para Dolphin",
        "features.dolphin.desc": "Integración nativa perfecta con el emulador Dolphin para garantizar rendimiento y estabilidad.",
        "cta.title": "¿Listo para encender los motores?",
        "cta.desc": "Descarga nuestro PC Launcher ahora. Incluye todas las herramientas para instalar VanzaKart automáticamente.",
        "cta.btn": "Descargar VanzaKart Launcher",
        "cta.note": "Requiere Windows 10/11 - ~3GB (Descarga inicial)",
        "footer.copy": "&copy; 2026 Lacly's Paradise. Todos los derechos reservados.",
        "footer.discord": "Únete al servidor de Discord",
        "js.btn.prep": "Preparando...",
        "js.btn.done": "¡Descarga iniciada!",
        "nav.team": "Nuestro Equipo",
        "team.meta.title": "VanzaKart Modpack - Nuestro Equipo",
        "team.hero.title": "Nuestro <span class=\"gradient-text\">Equipo</span>",
        "team.hero.subtitle": "Los creadores, desarrolladores y colaboradores que hicieron posible el proyecto.",
        "team.role.devs": "Desarrolladores",
        "team.role.lead": "Desarrollador Principal",
        "team.role.launcher": "Desarrollador del Launcher",
        "team.role.web": "Desarrollador Web",
        "team.role.graphics": "Gráficos y Audio",
        "team.role.art": "Director de Arte y Sonido",
        "team.role.tester": "Beta Tester",
        "team.role.qa": "QA Tester",
        "team.desc.dev1": "El creador del modpack, con una adición de 152 mapas personalizados, los mejores mapas personalizados.",
        "team.desc.dev2": "El creador del launcher.",
        "team.desc.dev3": "El creador del sitio web, con toda su estética e información precisa.",
        "team.desc.graphics": "Artista de efectos visuales y diseño de sonido.",
        "team.desc.tester": "El tester del launcher, verificó que no hubiera errores y que la descarga fuera óptima.",
        "team.btn.support": "Apoyar",
        "nav.guide": "Guía",
        "guide.meta.title": "VanzaKart Modpack - Guía de Instalación",
        "guide.hero.title": "Guía de <span class=\"gradient-text\">Instalación</span>",
        "guide.hero.subtitle": "Aprende cómo instalar VanzaKart y configurar Dolphin.",
        "guide.video.title": "Videotutorial Próximamente",
        "guide.video.desc": "Estamos preparando un video para mostrarte los pasos.",
        "guide.steps.title": "Instrucciones paso a paso",
        "guide.step1.title": "Descargar el Launcher",
        "guide.step1.desc": "Visita la página principal y descarga nuestro Launcher Oficial.",
        "guide.step2.title": "Iniciar Instalación",
        "guide.step2.desc": "Ejecuta el archivo. El launcher descargará todo automáticamente.",
        "guide.step3.title": "Configurar Dolphin",
        "guide.step3.desc": "Asegúrate de configurar tu mando en el emulador en el primer inicio.",
        "guide.step4.title": "¡A jugar!",
        "guide.step4.desc": "Selecciona \"Launch VanzaKart\" y prepárate para correr."
    }
};

let currentLang = 'en'; // variable to hold current language

document.addEventListener('DOMContentLoaded', () => {
    // Imposta la lingua di default a 'en' se non presente in localStorage
    currentLang = localStorage.getItem('vanzakart_lang') || 'en';

    // Applica subito la lingua e aggiorna l'UI al caricamento della pagina
    updateLanguage(currentLang);
    updateLangUI(currentLang);

    // ---- Reveal Header on Scroll ----
    const header = document.querySelector('.glass-header');
    window.addEventListener('scroll', () => {
        if (window.scrollY > 50) {
            header.style.background = 'rgba(8, 10, 20, 0.85)';
            header.style.boxShadow = '0 5px 20px rgba(0,0,0,0.3)';
        } else {
            header.style.background = 'rgba(8, 10, 20, 0.6)';
            header.style.boxShadow = 'none';
        }
    });

    // ---- 3D Tilt Effect on Feature Cards ----
    const cards = document.querySelectorAll('.feature-card');
    cards.forEach(card => {
        card.addEventListener('mousemove', e => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const centerX = rect.width / 2;
            const centerY = rect.height / 2;

            const rotateX = ((y - centerY) / centerY) * -5;
            const rotateY = ((x - centerX) / centerX) * 5;

            card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateY(-10px)`;
        });

        card.addEventListener('mouseleave', () => {
            card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) translateY(0px)';
        });
    });

    // ---- Dummy Download Button Click Example ----
    const downloadBtn = document.getElementById('downloadLauncherBtn');
    if (downloadBtn) {
        downloadBtn.addEventListener('click', () => {
            if (downloadBtn.classList.contains('downloading')) return;

            downloadBtn.classList.add('downloading');
            const originalText = downloadBtn.innerHTML;

            const btnTextSpan = downloadBtn.querySelector('span');
            const prepText = translations[currentLang]['js.btn.prep'];
            const doneText = translations[currentLang]['js.btn.done'];

            downloadBtn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> <span>${prepText}</span>`;
            downloadBtn.style.opacity = '0.8';
            downloadBtn.style.cursor = 'wait';

            setTimeout(() => {
                downloadBtn.innerHTML = `<i class="fa-solid fa-check"></i> <span>${doneText}</span>`;
                downloadBtn.classList.replace('btn-primary', 'btn-secondary');

                setTimeout(() => {
                    downloadBtn.innerHTML = originalText;
                    // re-apply active translation as innerHTML reset it
                    updateLanguage(currentLang);
                    downloadBtn.classList.replace('btn-secondary', 'btn-primary');
                    downloadBtn.style.opacity = '1';
                    downloadBtn.style.cursor = 'pointer';
                    downloadBtn.classList.remove('downloading');
                }, 3000);
            }, 1500);
        });
    }

    // ---- Smooth Scroll for Anchors ----
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // ---- Language Switcher Logic ----
    const langBtn = document.getElementById('langBtn');
    const langDropdown = document.getElementById('langDropdown');
    const langOptions = document.querySelectorAll('.lang-option');
    const currLangLabel = document.getElementById('currentLang');

    if (langBtn && langDropdown) {
        // Toggle Dropdown
        langBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            langDropdown.classList.toggle('show');
        });

        // Close when clicking outside
        document.addEventListener('click', () => {
            if (langDropdown.classList.contains('show')) {
                langDropdown.classList.remove('show');
            }
        });

        // Switch Language
        langOptions.forEach(opt => {
            opt.addEventListener('click', (e) => {
                e.preventDefault();
                const selectedLang = opt.getAttribute('data-lang');
                if (selectedLang === currentLang) return; // same lang

                // Set Lang
                currentLang = selectedLang;
                localStorage.setItem('vanzakart_lang', currentLang);

                updateLangUI(currentLang);
                updateLanguage(currentLang);
            });
        });
    }

    function updateLangUI(lang) {
        const _langOptions = document.querySelectorAll('.lang-option');
        const _currLangLabel = document.getElementById('currentLang');

        if (!_langOptions || !_currLangLabel) return;

        // Update active state in Dropdown
        _langOptions.forEach(o => {
            if (o.getAttribute('data-lang') === lang) {
                o.classList.add('active');
            } else {
                o.classList.remove('active');
            }
        });

        // Update Label
        const flagsHtml = {
            'it': '<img src="https://flagcdn.com/w20/it.png" srcset="https://flagcdn.com/w40/it.png 2x" width="16" alt="IT"> IT',
            'en': '<img src="https://flagcdn.com/w20/gb.png" srcset="https://flagcdn.com/w40/gb.png 2x" width="16" alt="EN"> EN',
            'es': '<img src="https://flagcdn.com/w20/es.png" srcset="https://flagcdn.com/w40/es.png 2x" width="16" alt="ES"> ES',
            'de': '<img src="https://flagcdn.com/w20/de.png" srcset="https://flagcdn.com/w40/de.png 2x" width="16" alt="DE"> DE',
            'fr': '<img src="https://flagcdn.com/w20/fr.png" srcset="https://flagcdn.com/w40/fr.png 2x" width="16" alt="FR"> FR'
        };
        _currLangLabel.innerHTML = flagsHtml[lang] || lang.toUpperCase();
        document.documentElement.lang = lang;
    }

    function updateLanguage(lang) {
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (translations[lang] && translations[lang][key]) {
                el.innerHTML = translations[lang][key];
            }
        });

        document.querySelectorAll('[data-i18n-attr]').forEach(el => {
            const attrConfig = el.getAttribute('data-i18n-attr').split('|');
            if (attrConfig.length === 2) {
                const attrName = attrConfig[0];
                const key = attrConfig[1];
                if (translations[lang] && translations[lang][key]) {
                    el.setAttribute(attrName, translations[lang][key]);
                }
            }
        });
    }
});